{% extends 'base.html.twig' %}

{% block title %}Dashboard - Sistema de Gestión IRNR{% endblock %}

{% block body %}
<div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
    <h1>Sistema de Gestión de Expedientes IRNR</h1>
    
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 30px 0;">
        <!-- Card Clientes -->
        <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 10px 0; color: #495057;">Total Clientes</h3>
            <p style="font-size: 36px; font-weight: bold; margin: 0; color: #007bff;">{{ total_clients }}</p>
            <a href="{{ path('app_client_index') }}" style="color: #007bff; text-decoration: none;">Ver todos →</a>
        </div>
        
        <!-- Card Expedientes -->
        <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 10px 0; color: #495057;">Total Expedientes</h3>
            <p style="font-size: 36px; font-weight: bold; margin: 0; color: #28a745;">{{ total_expedientes }}</p>
            <a href="{{ path('app_expediente_index') }}" style="color: #28a745; text-decoration: none;">Ver todos →</a>
        </div>
        
        <!-- Card Declaraciones Pendientes -->
        <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 10px 0; color: #495057;">Declaraciones Pendientes</h3>
            <p style="font-size: 36px; font-weight: bold; margin: 0; color: #ffc107;">{{ declaraciones_pendientes }}</p>
            <a href="{{ path('app_declaracion_index') }}" style="color: #ffc107; text-decoration: none;">Ver todas →</a>
        </div>
    </div>
    
    <div style="background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h2>Últimos Expedientes</h2>
        
        {% if ultimos_expedientes|length > 0 %}
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f8f9fa;">
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">Número</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">Cliente</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">Tipo</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">Ejercicio</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">Estado</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">Fecha Apertura</th>
                    </tr>
                </thead>
                <tbody>
                    {% for expediente in ultimos_expedientes %}
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">{{ expediente.numeroExpediente }}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">{{ expediente.client.nombreCompleto }}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">{{ expediente.tipoExpediente }}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">{{ expediente.ejercicioFiscal }}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">
                            <span style="padding: 4px 8px; border-radius: 4px; background: #e7f3ff; color: #004085;">
                                {{ expediente.estado }}
                            </span>
                        </td>
                        <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">{{ expediente.fechaApertura|date('d/m/Y') }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p style="color: #6c757d;">No hay expedientes registrados aún.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
